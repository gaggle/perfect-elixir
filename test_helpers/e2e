source_bootstrap() {
  echo ""
  echo "SOURCING BOOTSTRAP"
  source /tmp/bootstrap > ~/output.txt
}

assert_output() {
  echo -n "Output contains: \"$1\"… "
  if grep -q "$1" ~/output.txt; then
    echo -e "\033[0;32m✔\033[0m"
    grep_status=0
  else
    echo -e "\033[0;31m✘\033[0m"
    grep_status=1
  fi

  echo "::group::(Output)"
  cat ~/output.txt
  echo "::endgroup::"

  if [ $grep_status -ne 0 ]; then
    exit 1
  fi
}

do_step() {
  local step_desc="$1"
  shift
  local commands=("$@")

  > ~/output.txt
  echo -n "Step: ${step_desc}… "
  for cmd in "${commands[@]}"; do
    eval "$cmd" >> ~/output.txt 2>&1
    local cmd_status=$?
    if [ $cmd_status -ne 0 ]; then
      echo -e "\033[0;31m✘\033[0m"

      echo "::group::(Output)"
      cat ~/output.txt
      echo "::endgroup::"

      exit 1
    fi
  done

  echo -e "\033[0;32m✔\033[0m"

  echo "::group::(Output)"
  cat ~/output.txt
  echo "::endgroup::"
}
